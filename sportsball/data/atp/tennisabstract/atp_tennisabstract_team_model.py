"""TennisAbstract team model."""

# pylint: disable=duplicate-code,too-many-locals,too-many-arguments
import datetime

import pytest_is_running
from scrapesession.scrapesession import ScrapeSession  # type: ignore

from ....cache import MEMORY
from ...delimiter import DELIMITER
from ...google.google_news_model import create_google_news_models
from ...league import League
from ...team_model import VERSION, TeamModel
from ...x.x_social_model import create_x_social_model
from .atp_tennisabstract_player_model import create_tennisabstract_player_model


def _create_tennisabstract_team_model(
    session: ScrapeSession,
    dt: datetime.datetime,
    league: League,
    player_urls: list[str],
    ace_percentages: list[float],
    double_fault_percentages: list[float],
    first_serves_ins: list[float],
    first_serve_percentages: list[float],
    second_serve_percentages: list[float],
    break_points_saveds: list[float],
    return_points_won_percentages: list[float],
    winners: list[int],
    winners_fronthands: list[int],
    winners_backhands: list[int],
    unforced_errors: list[int],
    unforced_errors_fronthand: list[int],
    unforced_errors_backhand: list[int],
    serve_points: list[int],
    serves_won: list[float],
    serves_aces: list[float],
    serves_unreturned: list[float],
    serves_forced_error_percentage: list[float],
    serves_won_in_three_shots_or_less: list[float],
    serves_wide_percentage: list[float],
    serves_body_percentage: list[float],
    serves_t_percentage: list[float],
    serves_wide_deuce_percentage: list[float],
    serves_body_deuce_percentage: list[float],
    serves_t_deuce_percentage: list[float],
    serves_wide_ad_percentage: list[float],
    serves_body_ad_percentage: list[float],
    serves_t_ad_percentage: list[float],
    serves_net_percentage: list[float],
    serves_wide_direction_percentage: list[float],
    shots_deep_percentage: list[float],
    shots_deep_wide_percentage: list[float],
    shots_foot_errors_percentage: list[float],
    shots_unknown_percentage: list[float],
    points_won_percentage: list[float],
    version: str,
    points: float,
) -> TeamModel:
    players = [
        create_tennisabstract_player_model(
            session=session,
            dt=dt,
            league=league,
            url=x,
            ace_percentages=ace_percentages,
            team_idx=count,
            double_fault_percentages=double_fault_percentages,
            first_serves_ins=first_serves_ins,
            first_serve_percentages=first_serve_percentages,
            second_serve_percentages=second_serve_percentages,
            break_points_saveds=break_points_saveds,
            return_points_won_percentages=return_points_won_percentages,
            winners=winners,
            winners_fronthands=winners_fronthands,
            winners_backhands=winners_backhands,
            unforced_errors=unforced_errors,
            unforced_errors_fronthand=unforced_errors_fronthand,
            unforced_errors_backhand=unforced_errors_backhand,
            serve_points=serve_points,
            serves_won=serves_won,
            serves_aces=serves_aces,
            serves_unreturned=serves_unreturned,
            serves_forced_error_percentage=serves_forced_error_percentage,
            serves_won_in_three_shots_or_less=serves_won_in_three_shots_or_less,
            serves_wide_percentage=serves_wide_percentage,
            serves_body_percentage=serves_body_percentage,
            serves_t_percentage=serves_t_percentage,
            serves_wide_deuce_percentage=serves_wide_deuce_percentage,
            serves_body_deuce_percentage=serves_body_deuce_percentage,
            serves_t_deuce_percentage=serves_t_deuce_percentage,
            serves_wide_ad_percentage=serves_wide_ad_percentage,
            serves_body_ad_percentage=serves_body_ad_percentage,
            serves_t_ad_percentage=serves_t_ad_percentage,
            serves_net_percentage=serves_net_percentage,
            serves_wide_direction_percentage=serves_wide_direction_percentage,
            shots_deep_percentage=shots_deep_percentage,
            shots_deep_wide_percentage=shots_deep_wide_percentage,
            shots_foot_errors_percentage=shots_foot_errors_percentage,
            shots_unknown_percentage=shots_unknown_percentage,
            points_won_percentage=points_won_percentage,
        )
        for count, x in enumerate(player_urls)
    ]
    identifier = DELIMITER.join([x.identifier for x in players])
    name = DELIMITER.join([x.name for x in players])
    return TeamModel(
        identifier=identifier,
        name=name,
        players=players,
        odds=[],
        points=points,
        ladder_rank=None,
        location=None,
        news=create_google_news_models(name, session, dt, league),
        social=create_x_social_model(name, session, dt),
        coaches=[],
        lbw=None,
        end_dt=None,
        runs=None,
        wickets=None,
        overs=None,
        balls=None,
        byes=None,
        leg_byes=None,
        wides=None,
        no_balls=None,
        penalties=None,
        balls_per_over=None,
        fours=None,
        sixes=None,
        catches=None,
        catches_dropped=None,
        disposal_efficiency=None,
        uncontested_marks=None,
        total_possessions=None,
        tackles_inside_50=None,
        centre_clearances=None,
        stoppage_clearances=None,
        goal_accuracy=None,
        rushed_behinds=None,
        touched_behinds=None,
        left_behinds=None,
        left_posters=None,
        right_behinds=None,
        right_posters=None,
        total_interchange_count=None,
        interchange_count_q1=None,
        interchange_count_q2=None,
        interchange_count_q3=None,
        interchange_count_q4=None,
        game_winning_goals=None,
        headed_goals=None,
        inaccurate_crosses=None,
        inaccurate_long_balls=None,
        inaccurate_passes=None,
        inaccurate_through_balls=None,
        left_footed_shots=None,
        longball_percentage=None,
        offsides=None,
        penalty_kick_goals=None,
        penalty_kick_percentage=None,
        penalty_kick_shots=None,
        penalty_kicks_missed=None,
        possession_percentage=None,
        possession_time=None,
        right_footed_shots=None,
        shoot_out_goals=None,
        shoot_out_misses=None,
        shoot_out_percentage=None,
        shot_assists=None,
        shot_percentage=None,
        shots_headed=None,
        shots_off_target=None,
        shots_on_post=None,
        shots_on_target=None,
        through_ball_percentage=None,
        total_crosses=None,
        total_goals=None,
        total_long_balls=None,
        total_passes=None,
        total_shots=None,
        total_through_balls=None,
        draws=None,
        sub_outs=None,
        suspensions=None,
        time_ended=None,
        time_started=None,
        win_percentage=None,
        wins=None,
        won_corners=None,
        yellow_cards=None,
        clean_sheet=None,
        crosses_caught=None,
        goals_conceded=None,
        partial_clean_sheet=None,
        penalty_kick_conceded=None,
        penalty_kick_save_percentage=None,
        penalty_kicks_faced=None,
        penalty_kicks_saved=None,
        punches=None,
        saves=None,
        shoot_out_kicks_faced=None,
        shoot_out_kicks_saved=None,
        shoot_out_save_percentage=None,
        shots_faced=None,
        smothers=None,
        unclaimed_crosses=None,
        accurate_crosses=None,
        accurate_long_balls=None,
        accurate_passes=None,
        accurate_through_balls=None,
        cross_percentage=None,
        free_kick_goals=None,
        free_kick_percentage=None,
        free_kick_shots=None,
        game_winning_assists=None,
        blocked_shots=None,
        effective_clearances=None,
        effective_tackles=None,
        ineffective_tackles=None,
        interceptions=None,
        tackle_percentage=None,
        appearances=None,
        average_rating_from_correspondent=None,
        average_rating_from_data_feed=None,
        average_rating_from_editor=None,
        average_rating_from_user=None,
        did_not_play=None,
        fouls_committed=None,
        fouls_suffered=None,
        goal_difference=None,
        losses=None,
        lost_corners=None,
        minutes=None,
        own_goals=None,
        pass_percentage=None,
        red_cards=None,
        starts=None,
        sub_ins=None,
        pitch_count=None,
        strikes=None,
        strike_pitch_ratio=None,
        games_played=None,
        team_games_played=None,
        double_plays=None,
        opportunities=None,
        errors=None,
        passed_balls=None,
        outfield_assists=None,
        pickoffs=None,
        putouts=None,
        outs_on_field=None,
        triple_plays=None,
        balls_in_zone=None,
        extra_bases=None,
        outs_made=None,
        catcher_third_innings_played=None,
        catcher_caught_stealing=None,
        catcher_stolen_bases_allowed=None,
        catcher_earned_runs=None,
        is_qualified_catcher=None,
        is_qualified_pitcher=None,
        successful_chances=None,
        total_chances=None,
        full_innings_played=None,
        part_innings_played=None,
        fielding_percentage=None,
        range_factor=None,
        zone_rating=None,
        catcher_caught_stealing_percentage=None,
        catcher_era=None,
        def_warbr=None,
        perfect_games=None,
        wild_pitches=None,
        third_innings=None,
        team_earned_runs=None,
        shutouts=None,
        pickoff_attempts=None,
        run_support=None,
        pitches_as_starter=None,
        quality_starts=None,
        inherited_runners=None,
        inherited_runners_scored=None,
        opponent_total_bases=None,
        is_qualified_saves=None,
        full_innings=None,
        part_innings=None,
        blown_saves=None,
        innings=None,
        era=None,
        whip=None,
        caught_stealing_percentage=None,
        pitches_per_start=None,
        pitches_per_inning=None,
        run_support_average=None,
        opponent_average=None,
        opponent_slug_average=None,
        opponent_on_base_percentage=None,
        opponent_ops=None,
        save_percentage=None,
        strikeouts_per_nine_innings=None,
        strikeout_to_walk_ratio=None,
        tough_losses=None,
        cheap_wins=None,
        save_opportunities_per_win=None,
        runs_created=None,
        batting_average=None,
        pinch_average=None,
        slug_average=None,
        secondary_average=None,
        on_base_percentage=None,
        ops=None,
        ground_to_fly_ratio=None,
        runs_created_per_27_outs=None,
        batter_rating=None,
        at_bats_per_home_run=None,
        stolen_base_percentage=None,
        pitches_per_plate_appearance=None,
        isolated_power=None,
        walk_to_strikeout_ratio=None,
        walks_per_plate_appearance=None,
        secondary_average_minus_batting_average=None,
        runs_produced=None,
        runs_ratio=None,
        patience_ratio=None,
        balls_in_play_average=None,
        mlb_rating=None,
        offensive_wins_above_replacement=None,
        wins_above_replacement=None,
        earned_runs=None,
        batters_hit=None,
        sacrifice_bunts=None,
        save_opportunities=None,
        finishes=None,
        balks=None,
        batters_faced=None,
        holds=None,
        complete_games=None,
        hit_by_pitch=None,
        ground_balls=None,
        strikeouts=None,
        rbis=None,
        sac_hits=None,
        hits=None,
        stolen_bases=None,
        walks=None,
        catcher_interference=None,
        gidps=None,
        sacrifice_flies=None,
        at_bats=None,
        home_runs=None,
        grand_slam_home_runs=None,
        runners_left_on_base=None,
        triples=None,
        game_winning_rbis=None,
        intentional_walks=None,
        doubles=None,
        fly_balls=None,
        caught_stealing=None,
        pitches=None,
        games_started=None,
        pinch_at_bats=None,
        pinch_hits=None,
        player_rating=None,
        is_qualified=None,
        is_qualified_steals=None,
        total_bases=None,
        plate_appearances=None,
        projected_home_runs=None,
        extra_base_hits=None,
        average_game_score=None,
        average_field_goals_attempted=None,
        average_three_point_field_goals_made=None,
        average_three_point_field_goals_attempted=None,
        average_free_throws_made=None,
        average_free_throws_attempted=None,
        average_points=None,
        average_offensive_rebounds=None,
        average_assists=None,
        average_turnovers=None,
        offensive_rebound_percentage=None,
        estimated_possessions=None,
        average_estimated_possessions=None,
        points_per_estimated_possessions=None,
        average_team_turnovers=None,
        average_total_turnovers=None,
        two_point_field_goals_made=None,
        two_point_field_goals_attempted=None,
        average_two_point_field_goals_made=None,
        average_two_point_field_goals_attempted=None,
        two_point_field_goal_percentage=None,
        shooting_efficiency=None,
        scoring_efficiency=None,
        average_48_field_goals_made=None,
        average_48_field_goals_attempted=None,
        average_48_three_point_field_goals_made=None,
        average_48_three_point_field_goals_attempted=None,
        average_48_free_throws_made=None,
        average_48_free_throws_attempted=None,
        average_48_points=None,
        average_48_offensive_rebounds=None,
        average_48_assists=None,
        average_48_turnovers=None,
        average_rebounds=None,
        average_fouls=None,
        average_flagrant_fouls=None,
        average_technical_fouls=None,
        average_ejections=None,
        average_disqualifications=None,
        assist_turnover_ratio=None,
        steal_foul_ratio=None,
        block_foul_ratio=None,
        average_team_rebounds=None,
        total_technical_fouls=None,
        team_assist_turnover_ratio=None,
        steal_turnover_ratio=None,
        average_48_rebounds=None,
        average_48_fouls=None,
        average_48_flagrant_fouls=None,
        average_48_technical_fouls=None,
        average_48_ejections=None,
        average_48_disqualifications=None,
        double_double=None,
        triple_double=None,
        field_goals_made=None,
        free_throws_made=None,
        three_point_percentage=None,
        three_point_field_goals_made=None,
        team_turnovers=None,
        total_turnovers=None,
        points_in_paint=None,
        brick_index=None,
        fast_break_points=None,
        average_field_goals_made=None,
        turnover_points=None,
        average_defensive_rebounds=None,
        average_blocks=None,
        average_steals=None,
        average_48_defensive_rebounds=None,
        average_48_blocks=None,
        average_48_steals=None,
        largest_lead=None,
        disqualifications=None,
        flagrant_fouls=None,
        fouls=None,
        ejections=None,
        technical_fouls=None,
        vorp=None,
        average_minutes=None,
        nba_rating=None,
        version=version,
    )


@MEMORY.cache(ignore=["session"])
def _cached_create_tennisabstract_team_model(
    session: ScrapeSession,
    dt: datetime.datetime,
    league: League,
    player_urls: list[str],
    ace_percentages: list[float],
    double_fault_percentages: list[float],
    first_serves_ins: list[float],
    first_serve_percentages: list[float],
    second_serve_percentages: list[float],
    break_points_saveds: list[float],
    return_points_won_percentages: list[float],
    winners: list[int],
    winners_fronthands: list[int],
    winners_backhands: list[int],
    unforced_errors: list[int],
    unforced_errors_fronthand: list[int],
    unforced_errors_backhand: list[int],
    serve_points: list[int],
    serves_won: list[float],
    serves_aces: list[float],
    serves_unreturned: list[float],
    serves_forced_error_percentage: list[float],
    serves_won_in_three_shots_or_less: list[float],
    serves_wide_percentage: list[float],
    serves_body_percentage: list[float],
    serves_t_percentage: list[float],
    serves_wide_deuce_percentage: list[float],
    serves_body_deuce_percentage: list[float],
    serves_t_deuce_percentage: list[float],
    serves_wide_ad_percentage: list[float],
    serves_body_ad_percentage: list[float],
    serves_t_ad_percentage: list[float],
    serves_net_percentage: list[float],
    serves_wide_direction_percentage: list[float],
    shots_deep_percentage: list[float],
    shots_deep_wide_percentage: list[float],
    shots_foot_errors_percentage: list[float],
    shots_unknown_percentage: list[float],
    points_won_percentage: list[float],
    points: float,
    version: str,
) -> TeamModel:
    return _create_tennisabstract_team_model(
        session=session,
        dt=dt,
        league=league,
        player_urls=player_urls,
        ace_percentages=ace_percentages,
        double_fault_percentages=double_fault_percentages,
        first_serves_ins=first_serves_ins,
        first_serve_percentages=first_serve_percentages,
        second_serve_percentages=second_serve_percentages,
        break_points_saveds=break_points_saveds,
        return_points_won_percentages=return_points_won_percentages,
        winners=winners,
        winners_fronthands=winners_fronthands,
        winners_backhands=winners_backhands,
        unforced_errors=unforced_errors,
        unforced_errors_fronthand=unforced_errors_fronthand,
        unforced_errors_backhand=unforced_errors_backhand,
        serve_points=serve_points,
        serves_won=serves_won,
        serves_aces=serves_aces,
        serves_unreturned=serves_unreturned,
        serves_forced_error_percentage=serves_forced_error_percentage,
        serves_won_in_three_shots_or_less=serves_won_in_three_shots_or_less,
        serves_wide_percentage=serves_wide_percentage,
        serves_body_percentage=serves_body_percentage,
        serves_t_percentage=serves_t_percentage,
        serves_wide_deuce_percentage=serves_wide_deuce_percentage,
        serves_body_deuce_percentage=serves_body_deuce_percentage,
        serves_t_deuce_percentage=serves_t_deuce_percentage,
        serves_wide_ad_percentage=serves_wide_ad_percentage,
        serves_body_ad_percentage=serves_body_ad_percentage,
        serves_t_ad_percentage=serves_t_ad_percentage,
        serves_net_percentage=serves_net_percentage,
        serves_wide_direction_percentage=serves_wide_direction_percentage,
        shots_deep_percentage=shots_deep_percentage,
        shots_deep_wide_percentage=shots_deep_wide_percentage,
        shots_foot_errors_percentage=shots_foot_errors_percentage,
        shots_unknown_percentage=shots_unknown_percentage,
        points_won_percentage=points_won_percentage,
        points=points,
        version=version,
    )


def create_tennisabstract_team_model(
    session: ScrapeSession,
    dt: datetime.datetime,
    league: League,
    player_urls: list[str],
    ace_percentages: list[float],
    double_fault_percentages: list[float],
    first_serves_ins: list[float],
    first_serve_percentages: list[float],
    second_serve_percentages: list[float],
    break_points_saveds: list[float],
    return_points_won_percentages: list[float],
    winners: list[int],
    winners_fronthands: list[int],
    winners_backhands: list[int],
    unforced_errors: list[int],
    unforced_errors_fronthand: list[int],
    unforced_errors_backhand: list[int],
    serve_points: list[int],
    serves_won: list[float],
    serves_aces: list[float],
    serves_unreturned: list[float],
    serves_forced_error_percentage: list[float],
    serves_won_in_three_shots_or_less: list[float],
    serves_wide_percentage: list[float],
    serves_body_percentage: list[float],
    serves_t_percentage: list[float],
    serves_wide_deuce_percentage: list[float],
    serves_body_deuce_percentage: list[float],
    serves_t_deuce_percentage: list[float],
    serves_wide_ad_percentage: list[float],
    serves_body_ad_percentage: list[float],
    serves_t_ad_percentage: list[float],
    serves_net_percentage: list[float],
    serves_wide_direction_percentage: list[float],
    shots_deep_percentage: list[float],
    shots_deep_wide_percentage: list[float],
    shots_foot_errors_percentage: list[float],
    shots_unknown_percentage: list[float],
    points_won_percentage: list[float],
    points: float,
) -> TeamModel:
    """Create a team model from TennisAbstract."""
    if not pytest_is_running.is_running():
        return _cached_create_tennisabstract_team_model(
            session=session,
            dt=dt,
            league=league,
            player_urls=player_urls,
            ace_percentages=ace_percentages,
            double_fault_percentages=double_fault_percentages,
            first_serves_ins=first_serves_ins,
            first_serve_percentages=first_serve_percentages,
            second_serve_percentages=second_serve_percentages,
            break_points_saveds=break_points_saveds,
            return_points_won_percentages=return_points_won_percentages,
            winners=winners,
            winners_fronthands=winners_fronthands,
            winners_backhands=winners_backhands,
            unforced_errors=unforced_errors,
            unforced_errors_fronthand=unforced_errors_fronthand,
            unforced_errors_backhand=unforced_errors_backhand,
            serve_points=serve_points,
            serves_won=serves_won,
            serves_aces=serves_aces,
            serves_unreturned=serves_unreturned,
            serves_forced_error_percentage=serves_forced_error_percentage,
            serves_won_in_three_shots_or_less=serves_won_in_three_shots_or_less,
            serves_wide_percentage=serves_wide_percentage,
            serves_body_percentage=serves_body_percentage,
            serves_t_percentage=serves_t_percentage,
            serves_wide_deuce_percentage=serves_wide_deuce_percentage,
            serves_body_deuce_percentage=serves_body_deuce_percentage,
            serves_t_deuce_percentage=serves_t_deuce_percentage,
            serves_wide_ad_percentage=serves_wide_ad_percentage,
            serves_body_ad_percentage=serves_body_ad_percentage,
            serves_t_ad_percentage=serves_t_ad_percentage,
            serves_net_percentage=serves_net_percentage,
            serves_wide_direction_percentage=serves_wide_direction_percentage,
            shots_deep_percentage=shots_deep_percentage,
            shots_deep_wide_percentage=shots_deep_wide_percentage,
            shots_foot_errors_percentage=shots_foot_errors_percentage,
            shots_unknown_percentage=shots_unknown_percentage,
            points_won_percentage=points_won_percentage,
            points=points,
            version=VERSION,
        )
    with session.cache_disabled():
        return _create_tennisabstract_team_model(
            session=session,
            dt=dt,
            league=league,
            player_urls=player_urls,
            ace_percentages=ace_percentages,
            double_fault_percentages=double_fault_percentages,
            first_serves_ins=first_serves_ins,
            first_serve_percentages=first_serve_percentages,
            second_serve_percentages=second_serve_percentages,
            break_points_saveds=break_points_saveds,
            return_points_won_percentages=return_points_won_percentages,
            winners=winners,
            winners_fronthands=winners_fronthands,
            winners_backhands=winners_backhands,
            unforced_errors=unforced_errors,
            unforced_errors_fronthand=unforced_errors_fronthand,
            unforced_errors_backhand=unforced_errors_backhand,
            serve_points=serve_points,
            serves_won=serves_won,
            serves_aces=serves_aces,
            serves_unreturned=serves_unreturned,
            serves_forced_error_percentage=serves_forced_error_percentage,
            serves_won_in_three_shots_or_less=serves_won_in_three_shots_or_less,
            serves_wide_percentage=serves_wide_percentage,
            serves_body_percentage=serves_body_percentage,
            serves_t_percentage=serves_t_percentage,
            serves_wide_deuce_percentage=serves_wide_deuce_percentage,
            serves_body_deuce_percentage=serves_body_deuce_percentage,
            serves_t_deuce_percentage=serves_t_deuce_percentage,
            serves_wide_ad_percentage=serves_wide_ad_percentage,
            serves_body_ad_percentage=serves_body_ad_percentage,
            serves_t_ad_percentage=serves_t_ad_percentage,
            serves_net_percentage=serves_net_percentage,
            serves_wide_direction_percentage=serves_wide_direction_percentage,
            shots_deep_percentage=shots_deep_percentage,
            shots_deep_wide_percentage=shots_deep_wide_percentage,
            shots_foot_errors_percentage=shots_foot_errors_percentage,
            shots_unknown_percentage=shots_unknown_percentage,
            points_won_percentage=points_won_percentage,
            points=points,
            version=VERSION,
        )
